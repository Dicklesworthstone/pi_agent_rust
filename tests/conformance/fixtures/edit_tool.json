{
  "version": "1.0",
  "tool": "edit",
  "description": "Conformance tests for the edit tool",
  "cases": [
    {
      "name": "edit_simple_replace",
      "description": "Simple text replacement",
      "setup": [
        {"type": "create_file", "path": "test.txt", "content": "Hello, World!"}
      ],
      "input": {
        "path": "test.txt",
        "oldText": "World",
        "newText": "Rust"
      },
      "expected": {
        "content_contains": ["-Hello, World!", "+Hello, Rust!"],
        "details": {
          "oldLength": 5,
          "newLength": 4
        }
      }
    },
    {
      "name": "edit_multiline",
      "description": "Replace multiline content",
      "setup": [
        {"type": "create_file", "path": "test.txt", "content": "line1\nline2\nline3"}
      ],
      "input": {
        "path": "test.txt",
        "oldText": "line2",
        "newText": "replaced"
      },
      "expected": {
        "content_contains": ["-line2", "+replaced"]
      }
    },
    {
      "name": "edit_text_not_found",
      "description": "Editing non-existent text should error",
      "setup": [
        {"type": "create_file", "path": "test.txt", "content": "Hello, World!"}
      ],
      "input": {
        "path": "test.txt",
        "oldText": "NotFound",
        "newText": "New"
      },
      "expect_error": true,
      "error_contains": "not found",
      "expected": {}
    },
    {
      "name": "edit_multiple_occurrences",
      "description": "Multiple occurrences should error",
      "setup": [
        {"type": "create_file", "path": "test.txt", "content": "Hello Hello Hello"}
      ],
      "input": {
        "path": "test.txt",
        "oldText": "Hello",
        "newText": "Hi"
      },
      "expect_error": true,
      "error_contains": "occurrences",
      "expected": {}
    },
    {
      "name": "edit_nonexistent_file",
      "description": "Editing non-existent file should error",
      "input": {
        "path": "/nonexistent/file.txt",
        "oldText": "old",
        "newText": "new"
      },
      "expect_error": true,
      "error_contains": "not found",
      "expected": {}
    },
    {
      "name": "edit_with_special_chars",
      "description": "Edit text with special characters",
      "setup": [
        {"type": "create_file", "path": "test.txt", "content": "function() { return x; }"}
      ],
      "input": {
        "path": "test.txt",
        "oldText": "function() { return x; }",
        "newText": "const fn = () => x;"
      },
      "expected": {
        "content_contains": ["-function() { return x; }", "+const fn = () => x;"]
      }
    },
    {
      "name": "edit_preserves_whitespace",
      "description": "Edit should preserve exact whitespace",
      "setup": [
        {"type": "create_file", "path": "test.txt", "content": "  indented\n    more indented"}
      ],
      "input": {
        "path": "test.txt",
        "oldText": "  indented",
        "newText": "    changed"
      },
      "expected": {
        "content_contains": ["+    changed"]
      }
    },
    {
      "name": "edit_unicode_content",
      "description": "Edit file with Unicode content",
      "setup": [
        {"type": "create_file", "path": "test.txt", "content": "Hello 世界"}
      ],
      "input": {
        "path": "test.txt",
        "oldText": "世界",
        "newText": "World"
      },
      "expected": {
        "content_contains": ["-Hello 世界", "+Hello World"]
      }
    }
  ]
}
